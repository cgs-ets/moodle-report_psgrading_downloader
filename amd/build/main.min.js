define(["core/ajax"],function(e){function t(e,t){this.usernames=e,this.selectedActivities=t}return t.prototype.main=function(){this.selectSetting()},t.prototype.selectSetting=function(){let t=this;var e=document.querySelector(".psgrading-downloader-table");e&&Array.from(e.rows).forEach(e=>{e=e.cells[0].firstChild;"select_all"!=e.getAttribute("name")?e.addEventListener("click",t.selectByOneHandler.bind(t,this)):e.addEventListener("click",t.selectAllHandler.bind(t,this))})},t.prototype.selectByOneHandler=function(e,t){var r=t.target.getAttribute("value");t.target.checked?e.addUserToList(r):e.removeUserFromList(r)},t.prototype.addUserToList=function(e){var t=document.querySelector('input[name="selectedusers"]').value;(t=JSON.parse(t)).push(e),document.querySelector('input[name="selectedusers"]').value=JSON.stringify(t)},t.prototype.removeUserFromList=function(e){var t=JSON.parse(document.querySelector('input[name="selectedusers"]').value);t.splice(t.indexOf(e),1),document.querySelector('input[name="selectedusers"]').value=JSON.stringify(t)},t.prototype.selectAllHandler=function(e,t){var r=document.querySelectorAll('input[name="select_student[]"]');t.target.checked?document.querySelector('input[name="selectedusers"]').value=document.querySelector(".psgrading-downloader-table").getAttribute("data-all-users"):document.querySelector('input[name="selectedusers"]').value="[]",r.forEach(e=>{e.checked=!e.checked})},{init:function(){new t([],JSON.parse(document.querySelector(".psgrading-downloader-table").getAttribute("data-activities-json"))).main()}}});